[TOC]

# Конспект книги «‎Совершенный код»‎ Стива Макконнелла

## Глава 5. Проектировании при конструировании

### Проблемы, связанные с проектированием ПО

Проектирование ПО — разработка схемы преобразования спецификации (т.е. описанных требований) в готовое приложение

> Хорошее проектирование полезно при работе над небольшими приложениями и просто необходимо при работе над крупными (c. 71)

Но с проектированием связаны различные проблемы:

- **Проектирование — это [wicked problem](https://en.wikipedia.org/wiki/Wicked_problem)**. Требования могут быть противоречивыми, неполными, а некоторые могут быть идентифицированы только в процессе проектирования или даже по завершению разработки (см. [историю обрушения моста Tacoma Narrows](https://ru.wikipedia.org/wiki/%D0%A2%D0%B0%D0%BA%D0%BE%D0%BC%D1%81%D0%BA%D0%B8%D0%B9_%D0%BC%D0%BE%D1%81%D1%82)). Следовательно, вероятность успешно спроектировать что-то с первого раза на практике очень невелика.
- **Проектирование — это неряшливый процесс**. Он состоит из множества проб и ошибок и промежуточные результаты работы часто не похожи на что-то ясное и организованное.
- **Проектирование — это процесс поиска компромиссов и определения приоритетов**. Это этап, на котором нужно выбирать между конкурирующими характеристиками проекта: быстродействие или скорость разработки, требовательность к ресурсам или простота найма сотрудников и так далее.
- **Проектирование — это недетерменированный процесс**, т.е. могут существовать десятки хороших, но разных проектов одного и того же приложения.
- **Проектирование — это [эвристический процесс](https://ru.wikipedia.org/wiki/%D0%AD%D0%B2%D1%80%D0%B8%D1%81%D1%82%D0%B8%D0%BA%D0%B0#:~:text=%D0%92%20%D1%8D%D1%82%D0%BE%D0%BC%20%D1%81%D0%BC%D1%8B%D1%81%D0%BB%D0%B5%20%D1%8D%D0%B2%D1%80%D0%B8%D1%81%D1%82%D0%B8%D0%BA%D0%B0%20%D0%BF%D0%BE%D0%BD%D0%B8%D0%BC%D0%B0%D0%B5%D1%82%D1%81%D1%8F,%D0%B2%D0%B5%D1%82%D0%B2%D0%B5%D0%B9%20%D0%B2%20%D0%B4%D0%B5%D1%80%D0%B5%D0%B2%D0%B5%20%D0%B2%D0%B0%D1%80%D0%B8%D0%B0%D0%BD%D1%82%D0%BE%D0%B2%2C%20%D1%84%D0%BE%D1%80%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F) или, если говорить проще, творческий процесс**, поэтому его сложно формализовать.
- **Проектирование — это постепенный процесс**. Первая версия проекта впоследствии развивается и улучшается.

> Универсальных методик проектирования не существует (с. 74)

### Основные концепции проектирования

Программирование является сложным, потому что для написания программы требуется абсолютно точно определить принципы функционирования мира (в конкретной предметной области), при том, что сам мир является сложным, неогранизованным и часто непредсказуемым.

> Программные проекты редко терпят крах по техническим причинам. Чаще всего провал объясняется неадекватной выработкой требований, неудачным планированием и неэффективным управлением. Если же провал обусловлен всё-таки преимущественно технической причиной, очень часто ею оказывается неконтролируемая сложность (с. 75).

Поэтому, **необходимо бороться со сложностью**. Возможные приёмы:

- Разделить систему на подсистемы;
- Грамотно определить объекты и сущности;
- Писать программу в терминах предметной области, а не низкоуровневых деталей реализации.

При проектировании **необходимо стремиться к следующим характеристикам проекта**:

- Минимальная сложность
- Простота и удобство сопровождения
- Слабое сопряжение (loose coupling, минимизация связей между частями программы)
- Расширяемость (возможность улучшать систему, не нарушая основной структуры)
- Возможность повторного использования
- Высокий коэффициент объединения по входу (интенсивное использование вспомогательных низкоуровневых классов)
- Низкий или средний коэффициент разветвления по входу (класс использует небольшое число других классов)
- Портируемость
- Минимальная, но полная функциональность
- Стратификация
- Соответсвие стандартным методикам

Также при проектировании **необходимо прорабатывать следующие уровни**:

1. Cистема
2. Подсистемы/пакеты и правила их взаимодействия (диаграмма взаимодействия подсистем должна быть ациклическим графом, т.е. исключать циклические взаимосвязи между подсистемами)
3. Классы внутри подсистемы (очень важно определить детали взаимодействия каждого класса с элементами системы, т.е. интерфейс класса)
4. Данные и методы внутри класса
5. Методы

### Практические подходы и правила проектирования (эвристические принципы)

Самый популярных подход основан на (1) **определении объектов реального мира**. Необходимо определить:

- Объекты и их атрибуты
- Действия, которые можно выполнить с объектом
- Действия, которые этот объект может выполнять над другими объектами
- Видимые и невидимые части объекта
- Открытый интерфейс каждого объекта

Также важно (2) **определить согласованные абстрации**. Абстракции дают возможность задействовать часть программы (класс/библиотеку/пакет и т.д.), игнорируя детали её реализации. И это эффективный способ борьбы со сложностью.

> Удачный интерфейс класса — это асбтракция, позволяющая сосредоточиться на интерфейся, не беспокоясь о внутренних механизмах работы класса (стр. 86).

Ещё одно правило призывает нас (3) **инкапсулировать детали реализации**, чтобы они не были доступны извне определённой части программы.

(4) **Следует использовать наследование**, если некоторые объекты проектируемой системы аналогичны друг другу за исключением нескольких свойств. Эти свойства или методы, могут быть определены как [абстрактные](https://en.wikipedia.org/wiki/Virtual_function) на уровне класса, от которого происходит наследование, и реализованы в классах-наследниках.

